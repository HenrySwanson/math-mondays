(()=>{"use strict";var e={536:(e,t,r)=>{t.__esModule=!0,t.setListeners=t.resizeViewbox=t.SvgHydra=t.SvgHeadData=t.HydraSkeleton=t.CLONE_COLOR=void 0;t.CLONE_COLOR="#422aa8";var n=r(347);t.HydraSkeleton=function(e){this.tree=new n.Tree(null,e.map((function(e){return e.tree})))};var o=function(){function e(e,t,r){this.tree=new n.Tree({x:e,y:t},r.map((function(e){return e.tree})))}return e.fromTree=function(t){if(0===t.children.length)return new e(0,0,[]);for(var r=t.children.map((function(t,r){var n=e.fromTree(t);return n.shift(r,1),n})),n=0;n<r.length;n++)for(var o=n-1;o>=0;o--){for(var a=r[n].leftContour(),i=r[o].rightContour(),l=Math.min(a.length,i.length),h=1,c=0;c<l;c++)h=Math.min(h,a[c]-i[c]);if(!(h>=1)){var p=1-h,u=n-o;for(c=1;c<=u;c++)r[o+c].shift(p*c/u,0)}}var d=(r[0].tree.payload.x+r[r.length-1].tree.payload.x)/2;return r.forEach((function(e){return e.shift(-d,0)})),new e(0,0,r)},e.prototype.shift=function(e,t){this.tree.forEachPreorder((function(r){r.x+=e,r.y+=t}))},e.prototype._contour=function(e){var t=[];return this.tree.forEachPreorder((function(r,n){var o=r.x;if(n<t.length){var a=t[n];("left"==e&&o<a||"right"==e&&o>a)&&(t[n]=o)}else t.push(o)})),t},e.prototype.leftContour=function(){return this._contour("left")},e.prototype.rightContour=function(){return this._contour("right")},e}(),a=function(e,t){this.head=e.circle(.5),t?(this.neck=e.line([0,0,0,0]).stroke({width:.1}),this.neck.back()):this.neck=null};t.SvgHeadData=a;var i=function(){function e(e,t){this.skeleton=t,this.svg_group=e.group(),this.svg_data_map=new Map,this.createSvgHeads(t.tree,!0)}return e.prototype.createSvgHeads=function(e,t){var r=this;void 0===t&&(t=!1);var n=this;e.forEachPreorderX((function(e){return n.svg_data_map.set(e,new a(r.svg_group,null!==e.parent))}))},e.prototype.repositionNodes=function(){var e=o.fromTree(this.skeleton.tree),t=Math.min.apply(Math,e.leftContour()),r=this;this.skeleton.tree.zipX(e.tree).forEachPreorderX((function(e){var n,o=e.parent,a=e.payload,i=a[0],l=a[1],h=r.svg_data_map.get(i),c=l.payload;if(h.head.center(2*c.y,1*c.x-t),null!==o){var p=o.payload[1].payload;null===(n=h.neck)||void 0===n||n.plot(2*c.y,1*c.x-t,2*p.y,1*p.x-t)}}))},e.prototype.index=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=(e=this.skeleton.tree).index.apply(e,t);return null===n?null:this.svg_data_map.get(n)},e.prototype.root=function(){return this.svg_data_map.get(this.skeleton.tree)},e}();function l(e,t){var r=function(e){var t=o.fromTree(e.skeleton.tree),r=Math.min.apply(Math,t.leftContour());return Math.max.apply(Math,t.rightContour())-r}(t),n=1*r;e.viewbox(-.75,-.95,7.5,n+1.4+.5)}t.SvgHydra=i,t.resizeViewbox=l,t.setListeners=function e(r,n,a,i){var h,c=n.svg_data_map.get(a);function p(){var t=a.parent;h.remove(),a.remove(),n.svg_data_map.delete(a);var o=t.parent;if(null!==o){for(var l=o.children.indexOf(t),c=[],p=0;p<2;p++){var s=t.makeCopy();o.insertSubtree(l+1,s),n.createSvgHeads(s),e(r,n,s,i),t.zipX(s).forEachPreorder((function(e){var t,r=e[0],o=e[1],a=n.svg_data_map.get(r),i=n.svg_data_map.get(o);i.head.move(a.head.x(),a.head.y()),null===(t=i.neck)||void 0===t||t.plot(a.neck.array())})),c.push(s)}c.forEach((function(e){return d(e)})),d(t).afterAll(u)}else u()}function u(){var e=o.fromTree(n.skeleton.tree),t=Math.min.apply(Math,e.leftContour());n.skeleton.tree.zipX(e.tree).forEachPreorderX((function(e){var r,o=e.payload[0],a=e.payload[1].payload,i=n.svg_data_map.get(o);if(i.head.animate(700,"<",0).center(2*a.y,1*a.x-t).fill("#000"),null!==e.parent){var l=e.parent.payload[1].payload;(null===(r=i.neck)||void 0===r?void 0:r.animate(700,"<",0)).plot(2*a.y,1*a.x-t,2*l.y,1*l.x-t).stroke("#000")}})),l(r.animate(700,"<",0),n),0===n.skeleton.tree.children.length&&alert("Wow... I can't believe you actually did it!\nSorry I didn't write anything cool for you yet. Perhaps I'll add something later.")}function d(e){e.children.forEach((function(e){return d(e)}));var r=n.svg_data_map.get(e);return null!==r.neck&&r.neck.animate(200,"<",0).stroke(t.CLONE_COLOR),r.head.animate(200,"<",0).fill(t.CLONE_COLOR)}c.head.click((function(){null!==a.parent&&0===a.children.length&&(i(),(h=r.group().add(c.neck).add(c.head)).animate(500,">",0).opacity(0).afterAll(p))})),a.children.forEach((function(t){return e(r,n,t,i)}))}},347:(e,t)=>{t.__esModule=!0,t.Tree=void 0;var r=function(){function e(e,t){var r=this;this.parent=null,this.children=t,this.payload=e,t.forEach((function(e){return e.parent=r}))}return e.prototype.index=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(0===t.length)return this;var n=t[0];return n<this.children.length?(e=this.children[n]).index.apply(e,t.slice(1)):null},e.prototype.makeCopy=function(){return new e(this.payload,this.children.map((function(e){return e.makeCopy()})))},e.prototype.insertSubtree=function(e,t){this.children.splice(e,0,t),t.parent=this},e.prototype.appendChild=function(t){var r=new e(t,[]);return r.parent=this,this.children.push(r),r},e.prototype.remove=function(){var e=this.parent;if(null!==e){var t=e.children.indexOf(this);e.children.splice(t,1),this.parent=null}},e.prototype.forEachPreorder=function(e,t){void 0===t&&(t=0),e(this.payload,t),this.children.forEach((function(r){return r.forEachPreorder(e,t+1)}))},e.prototype.forEachPreorderX=function(e,t){void 0===t&&(t=0),e(this,t),this.children.forEach((function(r){return r.forEachPreorderX(e,t+1)}))},e.prototype.zip=function(t){for(var r=[],n=Math.min(this.children.length,t.children.length),o=0;o<n;o++)r.push(this.children[o].zip(t.children[o]));return new e([this.payload,t.payload],r)},e.prototype.zipX=function(t){for(var r=[],n=Math.min(this.children.length,t.children.length),o=0;o<n;o++)r.push(this.children[o].zipX(t.children[o]));return new e([this,t],r)},e.prototype.map=function(t){return new e(t(this.payload),this.children.map((function(e){return e.map(t)})))},e}();t.Tree=r}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}(()=>{var e=r(536),t=document.getElementById("reset-button"),n=document.getElementById("click-counter"),o=SVG("hydra-interactive"),a=0;function i(){n.textContent="Clicks: "+a,a+=1}function l(){o.clear(),a=0,i();var t=new e.HydraSkeleton([]),r=t.tree.appendChild().appendChild();r.appendChild(),r.appendChild();var n=new e.SvgHydra(o,t);n.repositionNodes(),(0,e.resizeViewbox)(o,n),(0,e.setListeners)(o,n,n.skeleton.tree,i)}l(),t.addEventListener("click",l)})()})();